---
title: "Data analysis on marriage licences in Toronto"
subtitle: 
author: "Renjing Liu"
thanks: "Code and data are available at: https://github.com/MaxLiu728/First_Paper.git"
date: "2021/1/28"
output: html_document
abstract: "This study aims to explore the associations between number of issued marriage licenses in city of toronto and the month marriage registered.Our data is from open data toronto[@datasource], collecting marriage licenses information from four major civic centres in the city of toronto. From the analysis, we find all feedback from the civic centres showed couples in city of Toronto prefer to registor for their marriage in the summer time. Our findings can back up the city's operational requirements and guide some business functions, to meet the intentions of the publisher for this data set"
output: ###
toc: ###
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(opendatatoronto)
library(tidyverse)
library(ggplot2)
library(readr)
library(dplyr)
```

# Introduction
A marriage license is a legal document obtained by a couple prior to their marriage[Define ]. For nearly all couples, it is absolutely a big day when they legally registered their marriage, after which they will consider holding their ceremony and the wedding. As a result, the choice of the registered date must be extremely significant and seriously considered, which will normally be memorized and celebrated every year and affect the schedule of their weddings afterwards. Each couple usually have their unique option to set the date, for example, some of them prefer to register their marriage in one of their birthdays. 

However, I am curious with do they have a general preference on the season to register for their marriage? If so, what factors drive the months become popular? According to [popular], we assume summertime should be the most popular months, as the report has turned out most of couples are more likely to hold their weddings in the fall. 

I believe my findings can give some insightful implications for the future work of civic centres. Based on that, centres can adjust their internal operations in different months, to either satisfy the need of registering marriage licenses or avoid the waste of workforce.

The remainder of the paper will focus on the question I have pointed out, including the descriptions for my data set and the discussion for my results. 


# Data
This study will perform an analysis of data from [@datasource], which is monthly refreshed by the city clerk's office in Toronto. I selected the data from three categories: the code of civic centre, number of marriage licenses, month and year marriage registered. 

The limited ranges of civic centres may cause bias the selected data hardly represent the whole group of couples in the city of Toronto, it might only reflect a small group's preferences on the choice of time to register marriage. 

```{r, include=FALSE}
raw_data <- readr::read_csv("D:/MI/2178/Paper1/First_Paper/inputs/raw_data.csv") #Read the raw data, which has been tidied in my r script.
```


## Average issued marriage licenses in each civic centre
```{r Table_1, echo=FALSE}
# Separate the data set with types of civic centre
Df_kable<- raw_data %>%
  group_by(CIVIC_CENTRE) %>%
  summarise(Average_issued_licnenses= round(mean(MARRIAGE_LICENSES)))

Df_kable<- knitr::kable(Df_kable, 
                   format='pipe', 
                   caption = "Average number of issued marriage licenses",
                   col.names = c('Civic_centre', 'Issued_marriage_licenses'),
                   align = 'lccrrr')
Df_kable
```

```{r}

```



## Yearly change of average issued marriage licenses in each civic centre, from 2011 to 2021
```{r Figure_1, fig.cap="Yearly change", echo=FALSE, warning=FALSE}
# Prepare the dataframe for visualization
Df_fig_1<- raw_data %>%
  group_by(CIVIC_CENTRE, year) %>%
  summarise(Average_issued_licenses= round(mean(MARRIAGE_LICENSES)))

p1<- ggplot(data= as.data.frame(Df_fig_1),
            aes(x= year, 
               y= Average_issued_licenses, 
               fill= CIVIC_CENTRE),)+
  geom_col( position = "dodge",
           show.legend = TRUE)+
  labs(x= "Year",
       y= "Average number of marriage licenses",
       fill="Civic centre",
       title = "Yearly change of average number of marriage licenses issued in each civic centre",
       caption = "Source: opendatatoronto."
  )+
  scale_x_discrete(labels=c("2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021"))

p1
```

```{r}
#Explore the popular months people choose to get marriage licences
Df_Month<- raw_data %>%
  group_by(CIVIC_CENTRE, month) %>%
  summarise(Avg_licences= round(mean(MARRIAGE_LICENSES)))
```

  
# Create table for visualization
```{r}
Df2_1<- raw_data %>%
  group_by(CIVIC_CENTRE, year) %>%
  summarise(mean_value= round(mean(MARRIAGE_LICENSES)))
```

```{r Figure_1,  fig.cap="Yearly change", echo=FALSE}

```

```{r Figure_2, fig.cap="Monthly change", echo=FALSE}
p2<- ggplot(data= as.data.frame(Df_Month))+geom_point(aes(x=month, y= Avg_licences, color=CIVIC_CENTRE))
```

```{r}
dput(raw_data)
```


# Model

# Results


# Discussion



## First discussion point
People prefer to get married in summer.

## Second discussion point
The issued marriage licences did differ cross the type of civic centre; 
TO was the most popular civic centre before 2018, but the number of issued marriage licences experienced a dramartic decrease after that, more people begun to choose  NY and SC
## Weakness and next steps
I am curious the what factors affect people's choice on civic centre, like distance/ area/... 
I am also curious about why people prefer to get married in summer, I plan to have one-to-one talk with several people, to get more insights.


# Appendix {-}


# References

